{{/* ====================================================================
SKC BI Dashboard Telegram Alert Templates
Mobile-optimized alert formatting for Telegram channels
==================================================================== */}}

{{/* Base Telegram text template */}}
{{ define "telegram.skc.text" }}
{{- if eq .Status "firing" }}
ğŸ”¥ **ALERT FIRING** ğŸ”¥
{{- else }}
âœ… **ALERT RESOLVED** âœ…
{{- end }}

**Service:** {{ .GroupLabels.service | default "Unknown" }}
**Environment:** {{ .GroupLabels.environment | default "production" }}
**Severity:** {{ .GroupLabels.severity | title }}

{{ range .Alerts }}
**ğŸ“‹ Alert:** {{ .Annotations.summary }}
**ğŸ“ Details:** {{ .Annotations.description }}
{{- if .Labels.instance }}
**ğŸ–¥ï¸ Instance:** {{ .Labels.instance }}
{{- end }}
**â° Started:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{- if .EndsAt }}
**â° Ended:** {{ .EndsAt.Format "15:04 02-01-2006" }}
{{- end }}
{{ end }}

**ğŸ”— Quick Actions:**
â€¢ [ğŸ¯ Dashboard](http://localhost:3000)
â€¢ [ğŸ“Š Grafana](http://grafana.localhost:3000)
â€¢ [ğŸ” Prometheus](http://prometheus.localhost:9090)
{{ end }}

{{/* Critical alert template - for urgent issues */}}
{{ define "telegram.skc.critical" }}
ğŸš¨ğŸš¨ **CRITICAL ALERT** ğŸš¨ğŸš¨

**âš¡ IMMEDIATE ACTION REQUIRED âš¡**

**Service:** {{ .GroupLabels.service | default "Unknown" }}
**Environment:** {{ .GroupLabels.environment | default "production" }}

{{ range .Alerts }}
**ğŸ”¥ Critical Issue:** {{ .Annotations.summary }}
**ğŸ“‹ Description:** {{ .Annotations.description }}
{{- if .Labels.instance }}
**ğŸ–¥ï¸ Affected Instance:** {{ .Labels.instance }}
{{- end }}
**â° Started:** {{ .StartsAt.Format "15:04:05 02-01-2006" }}
{{- if .Annotations.runbook_url }}
**ğŸ“– Runbook:** {{ .Annotations.runbook_url }}
{{- end }}
{{ end }}

**âš ï¸ SLA IMPACT WARNING âš ï¸**
This may affect our 99.99% uptime commitment!

**ğŸš€ Emergency Actions:**
â€¢ [ğŸ¯ Live Dashboard](http://localhost:3000)
â€¢ [ğŸ“Š Grafana Alerts](http://grafana.localhost:3000)
â€¢ [ğŸš¨ Alertmanager](http://alertmanager.localhost:9093)
â€¢ [ğŸ“ On-Call Escalation](tel:+31123456789)

**Team:** @critical-response-team
{{ end }}

{{/* SLA breach template - highest priority */}}
{{ define "telegram.skc.sla" }}
ğŸš¨ğŸš¨ğŸš¨ **SLA BREACH DETECTED** ğŸš¨ğŸš¨ğŸš¨

**ğŸ’¥ 99.99% SLA COMMITMENT VIOLATED ğŸ’¥**

{{ range .Alerts }}
**Service:** {{ .Labels.service }}
**Issue:** {{ .Annotations.summary }}
**Impact:** {{ .Annotations.description }}
**Started:** {{ .StartsAt.Format "15:04:05 02-01-2006" }}
{{ end }}

**ğŸ“ˆ SLA Status:**
â€¢ Target: 99.99% uptime
â€¢ Current breach affects monthly SLA
â€¢ Customer impact: YES

**ğŸ†˜ IMMEDIATE ESCALATION:**
â€¢ PagerDuty alert sent
â€¢ Management notified
â€¢ Customer success team alerted

**ğŸ”§ Emergency Response:**
â€¢ [ğŸ“Š SLA Dashboard](http://grafana.localhost:3000/d/sla)
â€¢ [âš¡ Incident Management](http://localhost:3000/incident)
â€¢ [ğŸ“ Emergency Contact](tel:+31123456789)

**Team:** @sla-response @management @customer-success
{{ end }}

{{/* Warning alert template */}}
{{ define "telegram.skc.warning" }}
âš ï¸ **WARNING ALERT** âš ï¸

**Service:** {{ .GroupLabels.service | default "Unknown" }}
**Severity:** Warning Level

{{ range .Alerts }}
**âš ï¸ Issue:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
{{- if .Labels.instance }}
**ğŸ–¥ï¸ Instance:** {{ .Labels.instance }}
{{- end }}
**â° Detected:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ“Š Monitoring:**
This is a warning-level alert requiring attention but not immediately critical.

**ğŸ”— Investigation Tools:**
â€¢ [ğŸ“Š Grafana](http://grafana.localhost:3000)
â€¢ [ğŸ” Logs](http://kibana.localhost:5601)
â€¢ [âš¡ Metrics](http://prometheus.localhost:9090)
{{ end }}

{{/* Info alert template */}}
{{ define "telegram.skc.info" }}
â„¹ï¸ **INFO NOTIFICATION** â„¹ï¸

**Service:** {{ .GroupLabels.service | default "Unknown" }}
**Type:** Information

{{ range .Alerts }}
**ğŸ“‹ Info:** {{ .Annotations.summary }}
**ğŸ“ Details:** {{ .Annotations.description }}
**â° Time:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ’¡ Note:** This is an informational alert for awareness.
{{ end }}

{{/* Infrastructure alert template */}}
{{ define "telegram.skc.infrastructure" }}
ğŸ–¥ï¸ **INFRASTRUCTURE ALERT** ğŸ–¥ï¸

{{ range .Alerts }}
**ğŸ—ï¸ System:** {{ .Labels.instance }}
**âš ï¸ Issue:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
**ğŸ“Š Severity:** {{ .Labels.severity | title }}
**â° Started:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ”§ Recommended Actions:**
â€¢ Check system resource usage
â€¢ Review performance metrics  
â€¢ Monitor application response times

**ğŸ”— Infrastructure Tools:**
â€¢ [ğŸ–¥ï¸ Server Monitoring](http://grafana.localhost:3000/d/infrastructure)
â€¢ [ğŸ’¾ Disk Usage](http://grafana.localhost:3000/d/disk)
â€¢ [ğŸŒ Network Stats](http://grafana.localhost:3000/d/network)

**Team:** @infrastructure-team
{{ end }}

{{/* Database alert template */}}
{{ define "telegram.skc.database" }}
ğŸ—„ï¸ **DATABASE ALERT** ğŸ—„ï¸

{{ range .Alerts }}
**ğŸ’¾ Database:** {{ .Labels.service }}
**âš ï¸ Issue:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
**ğŸ–¥ï¸ Instance:** {{ .Labels.instance }}
**â° Started:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ”§ Recommended Actions:**
â€¢ Check database performance metrics
â€¢ Review slow query logs
â€¢ Monitor connection pools
â€¢ Verify replication status

**ğŸ”— Database Tools:**
â€¢ [ğŸ“Š DB Performance](http://grafana.localhost:3000/d/database)
â€¢ [ğŸ˜ PostgreSQL Stats](http://grafana.localhost:3000/d/postgresql)
â€¢ [ğŸ”„ Replication Status](http://grafana.localhost:3000/d/replication)

**Team:** @database-team
{{ end }}

{{/* Application alert template */}}
{{ define "telegram.skc.application" }}
ğŸ’» **APPLICATION ALERT** ğŸ’»

{{ range .Alerts }}
**ğŸ¯ Application:** SKC BI Dashboard
**âš™ï¸ Component:** {{ .Labels.service }}
**âš ï¸ Issue:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
**ğŸ“Š Severity:** {{ .Labels.severity | title }}
**â° Started:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ”§ Quick Checks:**
â€¢ [ğŸŒ App Health](http://localhost:3000/api/health)
â€¢ [ğŸ“Š Performance](http://grafana.localhost:3000/d/app-performance)
â€¢ [ğŸ“œ Error Logs](http://kibana.localhost:5601)

**ğŸ¯ User Impact:**
{{- if eq .GroupLabels.severity "critical" }}
â€¢ High - Users may be unable to access the application
{{- else if eq .GroupLabels.severity "warning" }}
â€¢ Medium - Some features may be degraded
{{- else }}
â€¢ Low - Minimal user impact expected
{{- end }}

**Team:** @application-team @frontend-team
{{ end }}

{{/* Business metrics alert template */}}
{{ define "telegram.skc.business" }}
ğŸ“ˆ **BUSINESS METRICS ALERT** ğŸ“ˆ

{{ range .Alerts }}
**ğŸ“Š Metric:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
**ğŸ“‰ Current Value:** {{ .Annotations.value | default "N/A" }}
**â° Detected:** {{ .StartsAt.Format "15:04 02-01-2006" }}
{{ end }}

**ğŸ¯ Business Impact:**
This alert indicates a significant change in business metrics that requires analysis.

**ğŸ“Š Analysis Tools:**
â€¢ [ğŸ“ˆ Revenue Dashboard](http://localhost:3000/revenue)
â€¢ [ğŸ‘¥ User Analytics](http://localhost:3000/analytics)
â€¢ [ğŸ¯ Conversion Metrics](http://localhost:3000/conversion)

**Team:** @business-intelligence @analytics-team
{{ end }}

{{/* Resolution notification template */}}
{{ define "telegram.skc.resolved" }}
âœ… **ALERT RESOLVED** âœ…

{{ range .Alerts }}
**âœ… Resolved:** {{ .Annotations.summary }}
**ğŸ¯ Service:** {{ .Labels.service }}
**â±ï¸ Duration:** {{ .StartsAt.Format "15:04" }} - {{ .EndsAt.Format "15:04" }}
**ğŸ“… Date:** {{ .StartsAt.Format "02-01-2006" }}
{{ end }}

**ğŸ‰ Status:** All systems normal
**âœ¨ Impact:** Issue automatically resolved

**ğŸ“Š Post-Resolution:**
â€¢ Monitor for recurring issues
â€¢ Review resolution in next team meeting
â€¢ Update runbooks if needed
{{ end }}

{{/* Maintenance window template */}}
{{ define "telegram.skc.maintenance" }}
ğŸ”§ **MAINTENANCE WINDOW** ğŸ”§

{{ range .Alerts }}
**ğŸ› ï¸ Activity:** {{ .Annotations.summary }}
**ğŸ“‹ Details:** {{ .Annotations.description }}
**â° Window:** {{ .StartsAt.Format "15:04" }} - {{ .EndsAt.Format "15:04" }}
**ğŸ“… Date:** {{ .StartsAt.Format "02-01-2006" }}
{{ end }}

**ğŸ“¢ Notice:**
Scheduled maintenance in progress. Some services may be temporarily unavailable.

**ğŸ“Š Status Updates:**
â€¢ [ğŸŒ Status Page](http://status.skc-company.com)
â€¢ [ğŸ“Š Live Monitoring](http://grafana.localhost:3000)

**Team:** @operations-team
{{ end }}

{{/* Test alert template */}}
{{ define "telegram.skc.test" }}
ğŸ§ª **TEST ALERT** ğŸ§ª

This is a test alert to verify Telegram integration is working correctly.

**âš¡ Test Details:**
â€¢ Alertmanager â†’ Telegram webhook â†’ Bot â†’ Channel
â€¢ All formatting and emoji rendering
â€¢ Link functionality and markdown parsing

**âœ… If you see this message, Telegram alerting is working!**

**ğŸ”— Test Resources:**
â€¢ [ğŸ¯ Dashboard](http://localhost:3000)
â€¢ [ğŸ“Š Grafana](http://grafana.localhost:3000)
â€¢ [ğŸš¨ Alertmanager](http://alertmanager.localhost:9093)
{{ end }} 